/* SPDX-License-Identifier: ((GPL-2.0 WITH Linux-syscall-note) OR BSD-2-Clause) */
/* remotefs.c - remote fs access
   Copyright (C) 1996-2022 Paul Sheer
 */


#include "inspect.h"
#include "global.h"

#include <config-mswin.h>
#include <error.h>

#include "remotefs.h"

int translate_mswin_lasterror (int mswin_error)
{E_
    switch (mswin_error) {
    case ERROR_INVALID_FUNCTION:
        return RFSERR_MSWIN_ERROR_INVALID_FUNCTION;
    case ERROR_FILE_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_FILE_NOT_FOUND;
    case ERROR_PATH_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_PATH_NOT_FOUND;
    case ERROR_TOO_MANY_OPEN_FILES:
        return RFSERR_MSWIN_ERROR_TOO_MANY_OPEN_FILES;
    case ERROR_ACCESS_DENIED:
        return RFSERR_MSWIN_ERROR_ACCESS_DENIED;
    case ERROR_INVALID_HANDLE:
        return RFSERR_MSWIN_ERROR_INVALID_HANDLE;
    case ERROR_ARENA_TRASHED:
        return RFSERR_MSWIN_ERROR_ARENA_TRASHED;
    case ERROR_NOT_ENOUGH_MEMORY:
        return RFSERR_MSWIN_ERROR_NOT_ENOUGH_MEMORY;
    case ERROR_INVALID_BLOCK:
        return RFSERR_MSWIN_ERROR_INVALID_BLOCK;
    case ERROR_BAD_ENVIRONMENT:
        return RFSERR_MSWIN_ERROR_BAD_ENVIRONMENT;
    case ERROR_BAD_FORMAT:
        return RFSERR_MSWIN_ERROR_BAD_FORMAT;
    case ERROR_INVALID_ACCESS:
        return RFSERR_MSWIN_ERROR_INVALID_ACCESS;
    case ERROR_INVALID_DATA:
        return RFSERR_MSWIN_ERROR_INVALID_DATA;
    case ERROR_INVALID_DRIVE:
        return RFSERR_MSWIN_ERROR_INVALID_DRIVE;
    case ERROR_CURRENT_DIRECTORY:
        return RFSERR_MSWIN_ERROR_CURRENT_DIRECTORY;
    case ERROR_NOT_SAME_DEVICE:
        return RFSERR_MSWIN_ERROR_NOT_SAME_DEVICE;
    case ERROR_NO_MORE_FILES:
        return RFSERR_MSWIN_ERROR_NO_MORE_FILES;
    case ERROR_WRITE_PROTECT:
        return RFSERR_MSWIN_ERROR_WRITE_PROTECT;
    case ERROR_BAD_UNIT:
        return RFSERR_MSWIN_ERROR_BAD_UNIT;
    case ERROR_NOT_READY:
        return RFSERR_MSWIN_ERROR_NOT_READY;
    case ERROR_BAD_COMMAND:
        return RFSERR_MSWIN_ERROR_BAD_COMMAND;
    case ERROR_CRC:
        return RFSERR_MSWIN_ERROR_CRC;
    case ERROR_BAD_LENGTH:
        return RFSERR_MSWIN_ERROR_BAD_LENGTH;
    case ERROR_SEEK:
        return RFSERR_MSWIN_ERROR_SEEK;
    case ERROR_NOT_DOS_DISK:
        return RFSERR_MSWIN_ERROR_NOT_DOS_DISK;
    case ERROR_SECTOR_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_SECTOR_NOT_FOUND;
    case ERROR_OUT_OF_PAPER:
        return RFSERR_MSWIN_ERROR_OUT_OF_PAPER;
    case ERROR_WRITE_FAULT:
        return RFSERR_MSWIN_ERROR_WRITE_FAULT;
    case ERROR_READ_FAULT:
        return RFSERR_MSWIN_ERROR_READ_FAULT;
    case ERROR_GEN_FAILURE:
        return RFSERR_MSWIN_ERROR_GEN_FAILURE;
    case ERROR_SHARING_VIOLATION:
        return RFSERR_MSWIN_ERROR_SHARING_VIOLATION;
    case ERROR_LOCK_VIOLATION:
        return RFSERR_MSWIN_ERROR_LOCK_VIOLATION;
    case ERROR_WRONG_DISK:
        return RFSERR_MSWIN_ERROR_WRONG_DISK;
    case ERROR_FCB_UNAVAILABLE:
        return RFSERR_MSWIN_ERROR_FCB_UNAVAILABLE;
    case ERROR_SHARING_BUFFER_EXCEEDED:
        return RFSERR_MSWIN_ERROR_SHARING_BUFFER_EXCEEDED;
    case ERROR_NOT_SUPPORTED:
        return RFSERR_MSWIN_ERROR_NOT_SUPPORTED;
    case ERROR_FILE_EXISTS:
        return RFSERR_MSWIN_ERROR_FILE_EXISTS;
    case ERROR_DUP_FCB:
        return RFSERR_MSWIN_ERROR_DUP_FCB;
    case ERROR_CANNOT_MAKE:
        return RFSERR_MSWIN_ERROR_CANNOT_MAKE;
    case ERROR_FAIL_I24:
        return RFSERR_MSWIN_ERROR_FAIL_I24;
    case ERROR_OUT_OF_STRUCTURES:
        return RFSERR_MSWIN_ERROR_OUT_OF_STRUCTURES;
    case ERROR_ALREADY_ASSIGNED:
        return RFSERR_MSWIN_ERROR_ALREADY_ASSIGNED;
    case ERROR_INVALID_PASSWORD:
        return RFSERR_MSWIN_ERROR_INVALID_PASSWORD;
    case ERROR_INVALID_PARAMETER:
        return RFSERR_MSWIN_ERROR_INVALID_PARAMETER;
    case ERROR_NET_WRITE_FAULT:
        return RFSERR_MSWIN_ERROR_NET_WRITE_FAULT;
    case ERROR_NO_PROC_SLOTS:
        return RFSERR_MSWIN_ERROR_NO_PROC_SLOTS;
    case ERROR_NOT_FROZEN:
        return RFSERR_MSWIN_ERROR_NOT_FROZEN;
    case ERROR_NO_ITEMS:
        return RFSERR_MSWIN_ERROR_NO_ITEMS;
    case ERROR_INTERRUPT:
        return RFSERR_MSWIN_ERROR_INTERRUPT;
    case ERROR_TOO_MANY_SEMAPHORES:
        return RFSERR_MSWIN_ERROR_TOO_MANY_SEMAPHORES;
    case ERROR_EXCL_SEM_ALREADY_OWNED:
        return RFSERR_MSWIN_ERROR_EXCL_SEM_ALREADY_OWNED;
    case ERROR_SEM_IS_SET:
        return RFSERR_MSWIN_ERROR_SEM_IS_SET;
    case ERROR_TOO_MANY_SEM_REQUESTS:
        return RFSERR_MSWIN_ERROR_TOO_MANY_SEM_REQUESTS;
    case ERROR_INVALID_AT_INTERRUPT_TIME:
        return RFSERR_MSWIN_ERROR_INVALID_AT_INTERRUPT_TIME;
    case ERROR_SEM_OWNER_DIED:
        return RFSERR_MSWIN_ERROR_SEM_OWNER_DIED;
    case ERROR_SEM_USER_LIMIT:
        return RFSERR_MSWIN_ERROR_SEM_USER_LIMIT;
    case ERROR_DISK_CHANGE:
        return RFSERR_MSWIN_ERROR_DISK_CHANGE;
    case ERROR_DRIVE_LOCKED:
        return RFSERR_MSWIN_ERROR_DRIVE_LOCKED;
    case ERROR_BROKEN_PIPE:
        return RFSERR_MSWIN_ERROR_BROKEN_PIPE;
    case ERROR_OPEN_FAILED:
        return RFSERR_MSWIN_ERROR_OPEN_FAILED;
    case ERROR_BUFFER_OVERFLOW:
        return RFSERR_MSWIN_ERROR_BUFFER_OVERFLOW;
    case ERROR_DISK_FULL:
        return RFSERR_MSWIN_ERROR_DISK_FULL;
    case ERROR_NO_MORE_SEARCH_HANDLES:
        return RFSERR_MSWIN_ERROR_NO_MORE_SEARCH_HANDLES;
    case ERROR_INVALID_TARGET_HANDLE:
        return RFSERR_MSWIN_ERROR_INVALID_TARGET_HANDLE;
    case ERROR_PROTECTION_VIOLATION:
        return RFSERR_MSWIN_ERROR_PROTECTION_VIOLATION;
    case ERROR_VIOKBD_REQUEST:
        return RFSERR_MSWIN_ERROR_VIOKBD_REQUEST;
    case ERROR_INVALID_CATEGORY:
        return RFSERR_MSWIN_ERROR_INVALID_CATEGORY;
    case ERROR_INVALID_VERIFY_SWITCH:
        return RFSERR_MSWIN_ERROR_INVALID_VERIFY_SWITCH;
    case ERROR_BAD_DRIVER_LEVEL:
        return RFSERR_MSWIN_ERROR_BAD_DRIVER_LEVEL;
    case ERROR_CALL_NOT_IMPLEMENTED:
        return RFSERR_MSWIN_ERROR_CALL_NOT_IMPLEMENTED;
    case ERROR_SEM_TIMEOUT:
        return RFSERR_MSWIN_ERROR_SEM_TIMEOUT;
    case ERROR_INSUFFICIENT_BUFFER:
        return RFSERR_MSWIN_ERROR_INSUFFICIENT_BUFFER;
    case ERROR_INVALID_NAME:
        return RFSERR_MSWIN_ERROR_INVALID_NAME;
    case ERROR_INVALID_LEVEL:
        return RFSERR_MSWIN_ERROR_INVALID_LEVEL;
    case ERROR_NO_VOLUME_LABEL:
        return RFSERR_MSWIN_ERROR_NO_VOLUME_LABEL;
    case ERROR_MOD_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_MOD_NOT_FOUND;
    case ERROR_PROC_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_PROC_NOT_FOUND;
    case ERROR_WAIT_NO_CHILDREN:
        return RFSERR_MSWIN_ERROR_WAIT_NO_CHILDREN;
    case ERROR_CHILD_NOT_COMPLETE:
        return RFSERR_MSWIN_ERROR_CHILD_NOT_COMPLETE;
    case ERROR_DIRECT_ACCESS_HANDLE:
        return RFSERR_MSWIN_ERROR_DIRECT_ACCESS_HANDLE;
    case ERROR_NEGATIVE_SEEK:
        return RFSERR_MSWIN_ERROR_NEGATIVE_SEEK;
    case ERROR_SEEK_ON_DEVICE:
        return RFSERR_MSWIN_ERROR_SEEK_ON_DEVICE;
    case ERROR_IS_JOIN_TARGET:
        return RFSERR_MSWIN_ERROR_IS_JOIN_TARGET;
    case ERROR_IS_JOINED:
        return RFSERR_MSWIN_ERROR_IS_JOINED;
    case ERROR_IS_SUBSTED:
        return RFSERR_MSWIN_ERROR_IS_SUBSTED;
    case ERROR_NOT_JOINED:
        return RFSERR_MSWIN_ERROR_NOT_JOINED;
    case ERROR_NOT_SUBSTED:
        return RFSERR_MSWIN_ERROR_NOT_SUBSTED;
    case ERROR_JOIN_TO_JOIN:
        return RFSERR_MSWIN_ERROR_JOIN_TO_JOIN;
    case ERROR_SUBST_TO_SUBST:
        return RFSERR_MSWIN_ERROR_SUBST_TO_SUBST;
    case ERROR_JOIN_TO_SUBST:
        return RFSERR_MSWIN_ERROR_JOIN_TO_SUBST;
    case ERROR_SUBST_TO_JOIN:
        return RFSERR_MSWIN_ERROR_SUBST_TO_JOIN;
    case ERROR_BUSY_DRIVE:
        return RFSERR_MSWIN_ERROR_BUSY_DRIVE;
    case ERROR_SAME_DRIVE:
        return RFSERR_MSWIN_ERROR_SAME_DRIVE;
    case ERROR_DIR_NOT_ROOT:
        return RFSERR_MSWIN_ERROR_DIR_NOT_ROOT;
    case ERROR_DIR_NOT_EMPTY:
        return RFSERR_MSWIN_ERROR_DIR_NOT_EMPTY;
    case ERROR_IS_SUBST_PATH:
        return RFSERR_MSWIN_ERROR_IS_SUBST_PATH;
    case ERROR_IS_JOIN_PATH:
        return RFSERR_MSWIN_ERROR_IS_JOIN_PATH;
    case ERROR_PATH_BUSY:
        return RFSERR_MSWIN_ERROR_PATH_BUSY;
    case ERROR_IS_SUBST_TARGET:
        return RFSERR_MSWIN_ERROR_IS_SUBST_TARGET;
    case ERROR_SYSTEM_TRACE:
        return RFSERR_MSWIN_ERROR_SYSTEM_TRACE;
    case ERROR_INVALID_EVENT_COUNT:
        return RFSERR_MSWIN_ERROR_INVALID_EVENT_COUNT;
    case ERROR_TOO_MANY_MUXWAITERS:
        return RFSERR_MSWIN_ERROR_TOO_MANY_MUXWAITERS;
    case ERROR_INVALID_LIST_FORMAT:
        return RFSERR_MSWIN_ERROR_INVALID_LIST_FORMAT;
    case ERROR_LABEL_TOO_LONG:
        return RFSERR_MSWIN_ERROR_LABEL_TOO_LONG;
    case ERROR_TOO_MANY_TCBS:
        return RFSERR_MSWIN_ERROR_TOO_MANY_TCBS;
    case ERROR_SIGNAL_REFUSED:
        return RFSERR_MSWIN_ERROR_SIGNAL_REFUSED;
    case ERROR_DISCARDED:
        return RFSERR_MSWIN_ERROR_DISCARDED;
    case ERROR_NOT_LOCKED:
        return RFSERR_MSWIN_ERROR_NOT_LOCKED;
    case ERROR_BAD_THREADID_ADDR:
        return RFSERR_MSWIN_ERROR_BAD_THREADID_ADDR;
    case ERROR_BAD_ARGUMENTS:
        return RFSERR_MSWIN_ERROR_BAD_ARGUMENTS;
    case ERROR_BAD_PATHNAME:
        return RFSERR_MSWIN_ERROR_BAD_PATHNAME;
    case ERROR_SIGNAL_PENDING:
        return RFSERR_MSWIN_ERROR_SIGNAL_PENDING;
    case ERROR_UNCERTAIN_MEDIA:
        return RFSERR_MSWIN_ERROR_UNCERTAIN_MEDIA;
    case ERROR_MAX_THRDS_REACHED:
        return RFSERR_MSWIN_ERROR_MAX_THRDS_REACHED;
    case ERROR_MONITORS_NOT_SUPPORTED:
        return RFSERR_MSWIN_ERROR_MONITORS_NOT_SUPPORTED;
    case ERROR_INVALID_SEGMENT_NUMBER:
        return RFSERR_MSWIN_ERROR_INVALID_SEGMENT_NUMBER;
    case ERROR_INVALID_CALLGATE:
        return RFSERR_MSWIN_ERROR_INVALID_CALLGATE;
    case ERROR_INVALID_ORDINAL:
        return RFSERR_MSWIN_ERROR_INVALID_ORDINAL;
    case ERROR_ALREADY_EXISTS:
        return RFSERR_MSWIN_ERROR_ALREADY_EXISTS;
    case ERROR_NO_CHILD_PROCESS:
        return RFSERR_MSWIN_ERROR_NO_CHILD_PROCESS;
    case ERROR_CHILD_ALIVE_NOWAIT:
        return RFSERR_MSWIN_ERROR_CHILD_ALIVE_NOWAIT;
    case ERROR_INVALID_FLAG_NUMBER:
        return RFSERR_MSWIN_ERROR_INVALID_FLAG_NUMBER;
    case ERROR_SEM_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_SEM_NOT_FOUND;
    case ERROR_INVALID_STARTING_CODESEG:
        return RFSERR_MSWIN_ERROR_INVALID_STARTING_CODESEG;
    case ERROR_INVALID_STACKSEG:
        return RFSERR_MSWIN_ERROR_INVALID_STACKSEG;
    case ERROR_INVALID_MODULETYPE:
        return RFSERR_MSWIN_ERROR_INVALID_MODULETYPE;
    case ERROR_INVALID_EXE_SIGNATURE:
        return RFSERR_MSWIN_ERROR_INVALID_EXE_SIGNATURE;
    case ERROR_EXE_MARKED_INVALID:
        return RFSERR_MSWIN_ERROR_EXE_MARKED_INVALID;
    case ERROR_BAD_EXE_FORMAT:
        return RFSERR_MSWIN_ERROR_BAD_EXE_FORMAT;
    case ERROR_ITERATED_DATA_EXCEEDS_64k:
        return RFSERR_MSWIN_ERROR_ITERATED_DATA_EXCEEDS_64k;
    case ERROR_INVALID_MINALLOCSIZE:
        return RFSERR_MSWIN_ERROR_INVALID_MINALLOCSIZE;
    case ERROR_DYNLINK_FROM_INVALID_RING:
        return RFSERR_MSWIN_ERROR_DYNLINK_FROM_INVALID_RING;
    case ERROR_IOPL_NOT_ENABLED:
        return RFSERR_MSWIN_ERROR_IOPL_NOT_ENABLED;
    case ERROR_INVALID_SEGDPL:
        return RFSERR_MSWIN_ERROR_INVALID_SEGDPL;
    case ERROR_AUTODATASEG_EXCEEDS_64k:
        return RFSERR_MSWIN_ERROR_AUTODATASEG_EXCEEDS_64k;
    case ERROR_RING2SEG_MUST_BE_MOVABLE:
        return RFSERR_MSWIN_ERROR_RING2SEG_MUST_BE_MOVABLE;
    case ERROR_RELOC_CHAIN_XEEDS_SEGLIM:
        return RFSERR_MSWIN_ERROR_RELOC_CHAIN_XEEDS_SEGLIM;
    case ERROR_INFLOOP_IN_RELOC_CHAIN:
        return RFSERR_MSWIN_ERROR_INFLOOP_IN_RELOC_CHAIN;
    case ERROR_ENVVAR_NOT_FOUND:
        return RFSERR_MSWIN_ERROR_ENVVAR_NOT_FOUND;
    case ERROR_NOT_CURRENT_CTRY:
        return RFSERR_MSWIN_ERROR_NOT_CURRENT_CTRY;
    case ERROR_NO_SIGNAL_SENT:
        return RFSERR_MSWIN_ERROR_NO_SIGNAL_SENT;
    case ERROR_FILENAME_EXCED_RANGE:
        return RFSERR_MSWIN_ERROR_FILENAME_EXCED_RANGE;
    case ERROR_RING2_STACK_IN_USE:
        return RFSERR_MSWIN_ERROR_RING2_STACK_IN_USE;
    case ERROR_META_EXPANSION_TOO_LONG:
        return RFSERR_MSWIN_ERROR_META_EXPANSION_TOO_LONG;
    case ERROR_INVALID_SIGNAL_NUMBER:
        return RFSERR_MSWIN_ERROR_INVALID_SIGNAL_NUMBER;
    case ERROR_THREAD_1_INACTIVE:
        return RFSERR_MSWIN_ERROR_THREAD_1_INACTIVE;
    case ERROR_INFO_NOT_AVAIL:
        return RFSERR_MSWIN_ERROR_INFO_NOT_AVAIL;
    case ERROR_LOCKED:
        return RFSERR_MSWIN_ERROR_LOCKED;
    case ERROR_BAD_DYNALINK:
        return RFSERR_MSWIN_ERROR_BAD_DYNALINK;
    case ERROR_TOO_MANY_MODULES:
        return RFSERR_MSWIN_ERROR_TOO_MANY_MODULES;
    case ERROR_NESTING_NOT_ALLOWED:
        return RFSERR_MSWIN_ERROR_NESTING_NOT_ALLOWED;
    }
    return RFSERR_MSWIN_ERROR_WITHOUT_TRANSLATION;
}

